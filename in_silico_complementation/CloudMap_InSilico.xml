<tool id="in_silico_complementation" name="CloudMap: in silico complementation">
    <description>Perform in silico complementation analysis on multiple tabular snpEff output files</description>
    <command interpreter="python">
        CloudMap_InSilico.py   -s "$summary_output_file" -o "$data_output_file"
		-i 
		#for $input_files in $input_series:
				"${input_files.input_files}"				
		#end for
		-n
		#for $input_files in $input_series:
				"${input_files.sample_names}"				
		#end for		
				
    </command>
    <inputs>
        <repeat min="1" name="input_series" title="Input file">
          <param name="input_files" type="data" format="tabular" label="snpEff annotated variants (tabular file)"/>
          <param name="sample_names" type="text" value="" size = "20" label="Sample name" help="Name should correspond to sample file">
            <validator type="length" min="1" message="You must provide a unique sample name" />
          </param>
        </repeat>
    </inputs>	
	
    <outputs>
        <data name="summary_output_file" format="tabular"/>
        <data name="data_output_file" format="tabular"/>
    </outputs>
    <tests>
        <test>
            <param name="input_files" value="1.txt"/>
            <param name="sample_names" value="2.txt"/>
            <output name="summary_output_file" file="summary_output_file.txt"/>
            <output name="data_output_file" file="data_output_file.txt"/>

        </test>
    </tests>
    <help>

.. class:: warningmark

**What it does**

This tool is part of the CloudMap pipeline for analysis of mutant genome sequences. For further details, please see `Gregory Minevich, Danny S. Park, Daniel Blankenberg, Richard J. Poole and Oliver Hobert.  CloudMap: A Cloud-based Pipeline for Analysis of Mutant Genome Sequences. (Genetics 2012 In Press)`__

    .. __: http://biochemistry.hs.columbia.edu/labs/hobert/literature.html

CloudMap workflows, shared histories and reference datasets are available at the `CloudMap Galaxy page`__. 

    .. __: http://usegalaxy.org/cloudmap

If performed on a large scale, forward genetic screens usually yield multiple alleles of individual loci, which define specific complementation groups. The traditional way to identify such complementation groups is via complementation tests performed by genetic crosses. If screens have revealed dozens of mutants, comprehensive complementation testing can be time-consuming and labor-intensive. Moreover, complementation tests are impossible to perform with dominant alleles and are sometimes subject to misleading results (such as allelic complementation or non-allelic non- complementation). With the decreasing costs of whole genome sequencing, it is now possible to simply sequence many mutants that result from a screen and determine in silico which mutants carry variants in the same locus. To allow such analysis, we developed the CloudMap “in silico Complementation Test” tool to compare tabular lists of annotated variants from the program snpEff (which have been filtered for quality (see Materials and Methods) and had common variants subtracted) for shared gene hits (alleles). 


This tool creates two output files: 

1 A summary file of the number of shared gene hits among the sequenced mutants sorted from most to fewest:

.. image:: http://biochemistry.hs.columbia.edu/labs/hobert/CloudMap/Supp.Fig.1_in-silico_compSumm.png
 
 


2 A corresponding file of the snpEff annotated alleles from each sample also sorted from most to fewest:

.. image:: http://biochemistry.hs.columbia.edu/labs/hobert/CloudMap/Supp.Fig.2_in-silico_compOut.png





------

**Citation:**

This tool is part of the CloudMap package from the Hobert Lab. If you use this tool, please cite `Gregory Minevich, Danny S Park, Daniel Blankenberg, Richard J. Poole, and Oliver Hobert.  CloudMap: A Cloud-based Pipeline for Analysis of Mutant Genome Sequences. (Genetics 2012 In Press)`__

    .. __: http://biochemistry.hs.columbia.edu/labs/hobert/literature.html

Correspondence to gm2123@columbia.edu (G.M.) or or38@columbia.edu (O.H.)


The annotated variant files used as input into this in silico complementation tool are generated by the snpEff program:

CINGOLANI, P., A. PLATTS, L. WANG LE, M. COON, T. NGUYEN et al., 2012 A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of Drosophila melanogaster strain w1118; iso-2; iso-3. Fly (Austin) 6: 80-92.
    </help>
</tool>
